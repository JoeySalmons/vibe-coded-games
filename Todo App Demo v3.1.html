--- START OF FILE Todo App Demo v3.html ---

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Upgraded Interactive Dashboard</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        /* --- Universal Styles & CSS Variables --- */
        :root {
            --bg-color: #121212;
            --card-bg: #1e1e1e;
            --primary-text: #e0e0e0;
            --secondary-text: #a0a0a0;
            --border-color: #333;
            --accent-color: #00aaff;
            --accent-hover: #0088cc;
            --success-color: #28a745;
            --danger-color: #dc3545;
            --font-family: 'Inter', sans-serif;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }
        
        body {
            font-family: var(--font-family);
            background-color: var(--bg-color);
            color: var(--primary-text);
            padding: 2rem;
            line-height: 1.6;
        }

        h1, h2 { text-align: center; margin-bottom: 1rem; }
        h1 { font-size: clamp(2rem, 5vw, 2.5rem); }
        h2 { font-size: clamp(1rem, 3vw, 1.25rem); color: var(--secondary-text); }

        /* --- Dashboard Layout --- */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(340px, 1fr));
            gap: 1.5rem;
            max-width: 1800px;
            margin: 2rem auto;
        }

        .card {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid var(--border-color);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            display: flex;
            flex-direction: column;
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        
        @media (hover: hover) {
            .card:hover { transform: translateY(-5px); box-shadow: 0 8px 20px rgba(0, 170, 255, 0.1); }
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 0.5rem;
        }

        /* --- UI Elements --- */
        input[type="text"], textarea, button {
            font-family: var(--font-family);
            padding: 0.75rem;
            border-radius: 6px;
            border: 1px solid var(--border-color);
            background-color: #2c2c2c;
            color: var(--primary-text);
            font-size: 16px; 
        }
        
        textarea { resize: vertical; min-height: 150px; width: 100%; }
        button { background-color: var(--accent-color); color: white; border: none; cursor: pointer; font-weight: 500; transition: background-color 0.2s; touch-action: manipulation; }
        button:hover { background-color: var(--accent-hover); }
        .input-group { display: flex; gap: 0.5rem; margin-bottom: 1rem; }
        .input-group input { flex-grow: 1; }
        ul { list-style: none; }
        details { cursor: pointer; }
        summary { color: var(--secondary-text); }

        /* --- Generic Delete Button Style --- */
        .delete-btn { background: none; border: none; color: var(--secondary-text); cursor: pointer; font-size: 1.2rem; padding: 0 0.5rem; }
        .delete-btn:hover { color: var(--danger-color); }

        /* --- Widgets --- */
        .flip-card { perspective: 1000px; cursor: pointer; min-height: 200px; }
        .flip-card-inner { position: relative; width: 100%; height: 100%; transition: transform 0.6s; transform-style: preserve-3d; }
        .flip-card.is-flipped .flip-card-inner { transform: rotateY(180deg); }
        .flip-card-front, .flip-card-back { position: absolute; width: 100%; height: 100%; -webkit-backface-visibility: hidden; backface-visibility: hidden; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; }
        .flip-card-back { transform: rotateY(180deg); text-align: left; align-items: flex-start; padding: 0 1rem; }

        .todo-list-widget .content { flex-grow: 1; overflow-y: auto; max-height: 250px; }
        .todo-list-widget li { display: flex; align-items: center; justify-content: space-between; padding: 0.5rem; border-bottom: 1px solid var(--border-color); transition: background-color 0.2s; }
        .todo-list-widget li:hover { background-color: #2c2c2c; }
        .todo-list-widget .todo-text { cursor: pointer; flex-grow: 1; padding: 0.25rem; }
        .todo-list-widget .todo-text.completed { text-decoration: line-through; color: var(--secondary-text); }
        
        .progress-widget .stats { display: flex; justify-content: space-around; margin-bottom: 1rem; font-weight: 500; }
        .progress-widget .progress-bar-container { width: 100%; background-color: #2c2c2c; border-radius: 8px; overflow: hidden; }
        .progress-widget .progress-bar { height: 24px; width: 0%; background-color: var(--success-color); border-radius: 8px; transition: width 0.5s ease-out; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; }
        
        .notes-widget .content { position: relative; flex-grow: 1; }
        .notes-widget #notes-saved-indicator { position: absolute; bottom: 10px; right: 10px; color: var(--success-color); font-size: 0.9rem; opacity: 0; transition: opacity 0.5s; }
        
        .quote-widget blockquote { font-size: 1.1rem; font-style: italic; border-left: 3px solid var(--accent-color); padding-left: 1rem; margin: 0; }
        .quote-widget figcaption { text-align: right; color: var(--secondary-text); margin-top: 0.5rem; }
        
        .flashcard-widget .flashcard { perspective: 1000px; background-color: #2c2c2c; border-radius: 8px; min-height: 150px; position: relative; margin-bottom: 1rem; }
        .flashcard-inner { position: relative; width: 100%; height: 100%; transition: transform 0.6s; transform-style: preserve-3d; }
        .flashcard.is-flipped .flashcard-inner { transform: rotateX(180deg); }
        .flashcard-front, .flashcard-back { position: absolute; width: 100%; height: 100%; -webkit-backface-visibility: hidden; backface-visibility: hidden; display: flex; justify-content: center; align-items: center; padding: 1rem; font-size: 1.1rem; text-align: center; }
        .flashcard-back { transform: rotateX(180deg); color: var(--accent-color); font-weight: bold; }
        .flashcard-controls, .add-flashcard-form { display: flex; gap: 0.5rem; margin-top: 1rem; }
        .add-flashcard-form { flex-direction: column; }
        #flashcard-list { max-height: 150px; overflow-y: auto; margin-top: 1rem; }
        #flashcard-list li { display: flex; justify-content: space-between; align-items: center; padding: 0.25rem; font-size: 0.9rem; }
        #flashcard-list li span { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

        .habit-tracker-grid { display: grid; grid-template-columns: 1fr 1.5fr; gap: 5px; } /* Changed to be responsive */
        .habit-row { display: contents; } /* Allows grid layout to apply to children */
        .habit-name-container { display: flex; justify-content: space-between; align-items: center; font-weight: 500; min-width: 0; /* Fix for flexbox + ellipsis */ }
        .habit-name-container span { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; } /* Truncate long names */
        .day-cells-container { display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; }
        .habit-tracker-grid .header { font-weight: bold; color: var(--secondary-text); padding-bottom: 5px; text-align: center; font-size: 0.9em; }
        .habit-tracker-grid .day-cell { aspect-ratio: 1 / 1; /* Make cells responsive squares */ border: 1px solid var(--border-color); border-radius: 4px; cursor: pointer; transition: background-color 0.2s; }
        .habit-tracker-grid .day-cell.completed { background-color: var(--success-color); border-color: var(--success-color); }
        
        .spinner-container { position: relative; width: 100%; padding-bottom: 100%; margin-bottom: 1rem; }
        #spinner-canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
        .spinner-container::after { content: '▼'; position: absolute; top: -10px; left: 50%; transform: translateX(-50%); font-size: 2rem; color: var(--accent-color); }
        .spinner-widget button { width: 100%; }
        .spinner-options-list li { font-size: 0.9rem; color: var(--secondary-text); display: flex; justify-content: space-between; align-items: center; }

        .danger-zone { text-align: center; margin-top: 3rem; padding: 2rem; border: 1px dashed var(--danger-color); border-radius: 12px; }
        #reset-data-btn { background-color: var(--danger-color); }
        #reset-data-btn:hover { background-color: #b02a37; }
        
    </style>
</head>
<body>

    <h1>Personal Interactive Dashboard</h1>
    <h2>Your life, organized and interactive. All data is saved in your browser.</h2>

    <div class="dashboard-grid">
        <!-- Widget sections will be populated by JS for brevity -->
        <!-- WIDGET 1: Get to Know Me Card -->
        <div class="card flip-card" id="profile-card"> <div class="flip-card-inner"> <div class="flip-card-front"> <h3 class="card-title">Meet the Dashboard</h3> <p>This dashboard is a collection of interactive, personalized web components.</p> <p style="color: var(--accent-color); margin-top: 1rem;">(Click me to learn more)</p> </div> <div class="flip-card-back"> <h3 class="card-title">Core Concepts</h3> <ul> <li><strong>Apps:</strong> Modular, useful components.</li> <li><strong>Personalized:</strong> Your data is saved locally.</li> <li><strong>Visual:</strong> Clean, interactive design.</li> <li><strong>Organization:</strong> Tools to structure your day.</li> </ul> </div> </div> </div>
        <!-- WIDGET 2: Todo List -->
        <div class="card todo-list-widget"> <h3 class="card-title">Todo List</h3> <div class="input-group"> <input type="text" id="todo-input" placeholder="Add a new task..."> <button id="add-todo-btn">Add</button> </div> <div class="content"> <ul id="todo-list"></ul> </div> </div>
        <!-- WIDGET 3: Task Progress Visualizer -->
        <div class="card progress-widget"> <h3 class="card-title">Task Progress</h3> <div class="stats"> <div>Total: <span id="total-tasks">0</span></div> <div>Completed: <span id="completed-tasks">0</span></div> <div>Pending: <span id="pending-tasks">0</span></div> </div> <div class="progress-bar-container"> <div class="progress-bar" id="progress-bar">0%</div> </div> <p style="text-align: center; margin-top: 1rem; color: var(--secondary-text);">Complete tasks in the Todo List to see your progress!</p> </div>
        <!-- WIDGET 4: Quick Notes -->
        <div class="card notes-widget"> <h3 class="card-title">Quick Notes</h3> <div class="content"> <textarea id="notes-area" placeholder="Jot down your thoughts here... everything is saved automatically."></textarea> <span id="notes-saved-indicator">Saved!</span> </div> </div>
        <!-- WIDGET 5: Quote of the Day -->
        <div class="card quote-widget"> <h3 class="card-title">Quote of the Day</h3> <blockquote id="quote-text">Loading...</blockquote> <figcaption>— <span id="quote-author">...</span></figcaption> </div>
        <!-- WIDGET 6: Flashcard Quizzer -->
        <div class="card flashcard-widget"> <h3 class="card-title">Flashcard Quizzer</h3> <div class="flashcard" id="flashcard"> <div class="flashcard-inner"> <div class="flashcard-front" id="flashcard-question"></div> <div class="flashcard-back" id="flashcard-answer"></div> </div> </div> <div class="flashcard-controls"> <button id="flip-flashcard-btn" style="flex-grow: 2;">Flip Card</button> <button id="next-flashcard-btn" style="flex-grow: 1;">Next</button> </div> <details style="margin-top: 1rem;"> <summary>Add & Manage Cards</summary> <div class="add-flashcard-form"> <input type="text" id="new-question-input" placeholder="Question"> <input type="text" id="new-answer-input" placeholder="Answer"> <button id="add-flashcard-btn">Add Card</button> </div> <h4 style="margin-top:1rem;font-size:1rem;color:var(--secondary-text);">My Cards</h4> <ul id="flashcard-list"></ul> </details> </div>
        <!-- WIDGET 7: Habit Tracker -->
        <div class="card habit-tracker-widget"> <h3 class="card-title">Weekly Habit Tracker</h3> <div id="habit-tracker-container"></div> <div class="input-group" style="margin-top: 1rem;"> <input type="text" id="habit-input" placeholder="Add new habit..."> <button id="add-habit-btn">Add</button> </div> </div>
        <!-- WIDGET 8: Decision Spinner -->
        <div class="card spinner-widget"> <h3 class="card-title">Decision Spinner</h3> <div class="spinner-container"> <canvas id="spinner-canvas"></canvas> </div> <button id="spin-btn">Spin the Wheel!</button> <details style="margin-top: 1rem;"> <summary>Customize options</summary> <div class="input-group" style="margin-top: 1rem;"> <input type="text" id="spinner-option-input" placeholder="Add new option..."> <button id="add-spinner-option-btn">Add</button> </div> <ul class="spinner-options-list" id="spinner-options-list"></ul> </details> </div>
    </div>
    
    <div class="danger-zone">
        <h3>Reset All Data</h3>
        <p style="color: var(--secondary-text); margin: 0.5rem 0 1rem 0;">This will permanently delete all your tasks, notes, habits, and custom items.</p>
        <button id="reset-data-btn">Clear Everything & Start Fresh</button>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {

    // --- 1. "Get to Know Me" Flippable Card ---
    document.getElementById('profile-card').addEventListener('click', (e) => e.currentTarget.classList.toggle('is-flipped'));

    // --- 2. Todo List & 3. Task Progress (No changes) ---
    const todoInput = document.getElementById('todo-input'), addTodoBtn = document.getElementById('add-todo-btn'), todoList = document.getElementById('todo-list');
    const totalTasksEl = document.getElementById('total-tasks'), completedTasksEl = document.getElementById('completed-tasks'), pendingTasksEl = document.getElementById('pending-tasks'), progressBar = document.getElementById('progress-bar');
    let todos = JSON.parse(localStorage.getItem('todos')) || [];
    const updateTaskProgress = () => {
        const total = todos.length, completed = todos.filter(t => t.completed).length, pending = total - completed;
        const percentage = total === 0 ? 0 : Math.round((completed / total) * 100);
        totalTasksEl.textContent = total; completedTasksEl.textContent = completed; pendingTasksEl.textContent = pending;
        progressBar.style.width = `${percentage}%`; progressBar.textContent = `${percentage}%`;
    };
    const saveTodos = () => { localStorage.setItem('todos', JSON.stringify(todos)); updateTaskProgress(); };
    const renderTodos = () => {
        todoList.innerHTML = todos.length === 0 ? `<li style="color: var(--secondary-text);">No tasks yet. Add one!</li>` :
            todos.map((todo, index) => `<li class="${todo.completed ? 'completed' : ''}"><span class="todo-text ${todo.completed ? 'completed' : ''}" data-index="${index}">${todo.text}</span><button class="delete-btn" data-index="${index}">&times;</button></li>`).join('');
        updateTaskProgress();
    };
    const addTodo = () => { const text = todoInput.value.trim(); if (text) { todos.push({ text, completed: false }); todoInput.value = ''; saveTodos(); renderTodos(); } };
    todoList.addEventListener('click', (e) => {
        if (!e.target.dataset.index) return;
        const index = parseInt(e.target.dataset.index, 10);
        if (e.target.classList.contains('todo-text')) todos[index].completed = !todos[index].completed;
        if (e.target.classList.contains('delete-btn')) todos.splice(index, 1);
        saveTodos(); renderTodos();
    });
    addTodoBtn.addEventListener('click', addTodo);
    todoInput.addEventListener('keypress', (e) => e.key === 'Enter' && addTodo());

    // --- 4. Quick Notes (No changes) ---
    const notesArea = document.getElementById('notes-area'), savedIndicator = document.getElementById('notes-saved-indicator');
    let saveTimeout;
    notesArea.value = localStorage.getItem('quickNotes') || '';
    notesArea.addEventListener('keyup', () => {
        clearTimeout(saveTimeout);
        saveTimeout = setTimeout(() => {
            localStorage.setItem('quickNotes', notesArea.value);
            savedIndicator.style.opacity = '1';
            setTimeout(() => { savedIndicator.style.opacity = '0'; }, 2000);
        }, 500);
    });

    // --- 5. Quote of the Day (No changes) ---
    const quoteTextEl = document.getElementById('quote-text');
    const quoteAuthorEl = document.getElementById('quote-author');
    const localQuotes = [
        { content: "The best way to predict the future is to create it.", author: "Peter Drucker" },
        { content: "The only way to do great work is to love what you do.", author: "Steve Jobs" },
        { content: "Success is not final, failure is not fatal: it is the courage to continue that counts.", author: "Winston Churchill" },
        { content: "Believe you can and you're halfway there.", author: "Theodore Roosevelt" }
    ];
    const setLocalQuote = () => {
        const quote = localQuotes[Math.floor(Math.random() * localQuotes.length)];
        quoteTextEl.textContent = quote.content;
        quoteAuthorEl.textContent = quote.author;
    };
    async function fetchQuote() {
        try {
            const response = await fetch('https://api.quotable.io/random');
            if (!response.ok) throw new Error('API Error');
            const data = await response.json();
            quoteTextEl.textContent = data.content;
            quoteAuthorEl.textContent = data.author;
        } catch (error) {
            console.error('Error fetching quote, using local fallback:', error);
            setLocalQuote();
        }
    }

    // --- 6. Flashcard Quizzer (No changes) ---
    const flashcard = document.getElementById('flashcard'), questionEl = document.getElementById('flashcard-question'), answerEl = document.getElementById('flashcard-answer'), flashcardListEl = document.getElementById('flashcard-list');
    let flashcards = JSON.parse(localStorage.getItem('flashcards')) || [{ q: 'What is "DOM"?', a: 'Document Object Model' }];
    const saveFlashcards = () => localStorage.setItem('flashcards', JSON.stringify(flashcards));
    const renderFlashcardList = () => {
        flashcardListEl.innerHTML = flashcards.map((card, index) => 
            `<li><span>${card.q.substring(0, 25)}...</span><button class="delete-btn" data-index="${index}">&times;</button></li>`
        ).join('');
    };
    const showFlashcard = () => {
        flashcard.classList.remove('is-flipped');
        if (flashcards.length === 0) {
            questionEl.textContent = 'No cards available. Add one below!';
            answerEl.textContent = '...';
            return;
        }
        const currentCard = flashcards[Math.floor(Math.random() * flashcards.length)];
        questionEl.textContent = currentCard.q;
        answerEl.textContent = currentCard.a;
    };
    document.getElementById('flip-flashcard-btn').addEventListener('click', () => flashcard.classList.toggle('is-flipped'));
    document.getElementById('next-flashcard-btn').addEventListener('click', showFlashcard);
    document.getElementById('add-flashcard-btn').addEventListener('click', () => {
        const qInput = document.getElementById('new-question-input'), aInput = document.getElementById('new-answer-input');
        if (qInput.value.trim() && aInput.value.trim()) {
            flashcards.push({ q: qInput.value.trim(), a: aInput.value.trim() });
            qInput.value = ''; aInput.value = '';
            saveFlashcards(); showFlashcard(); renderFlashcardList();
        }
    });
    flashcardListEl.addEventListener('click', (e) => {
        if (e.target.classList.contains('delete-btn')) {
            const index = parseInt(e.target.dataset.index, 10);
            flashcards.splice(index, 1);
            saveFlashcards(); showFlashcard(); renderFlashcardList();
        }
    });

    // --- 7. Habit Tracker (UPDATED) ---
    const habitContainer = document.getElementById('habit-tracker-container'), habitInput = document.getElementById('habit-input'), addHabitBtn = document.getElementById('add-habit-btn');
    let habits = JSON.parse(localStorage.getItem('habits')) || [{ name: 'Exercise', dates: [] }, { name: 'Read for 20 minutes', dates: [] }];
    const saveHabits = () => localStorage.setItem('habits', JSON.stringify(habits));
    const renderHabitTracker = () => {
        const grid = document.createElement('div');
        grid.className = 'habit-tracker-grid';
        
        // **UPDATED:** Logic to start the week on Sunday
        const today = new Date();
        const firstDayOfWeek = new Date(today.setDate(today.getDate() - today.getDay()));
        const dates = Array.from({ length: 7 }, (_, i) => {
            const d = new Date(firstDayOfWeek);
            d.setDate(d.getDate() + i);
            return d.toISOString().split('T')[0];
        });
        
        const dayHeaders = dates.map(d => `<div class="header">${new Date(d).toLocaleString('default', { weekday: 'short' })}</div>`).join('');
        grid.innerHTML = `<div class="header">Habit</div><div class="day-cells-container">${dayHeaders}</div>`;
        
        habits.forEach((habit, habitIndex) => {
            const dayCells = dates.map(dateStr => `<div class="day-cell ${habit.dates.includes(dateStr) ? 'completed' : ''}" data-habit-index="${habitIndex}" data-date="${dateStr}"></div>`).join('');
            // **UPDATED:** Added title attribute for full name on hover
            grid.innerHTML += `<div class="habit-row"><div class="habit-name-container"><span title="${habit.name}">${habit.name}</span><button class="delete-btn" data-habit-index="${habitIndex}">&times;</button></div><div class="day-cells-container">${dayCells}</div></div>`;
        });
        
        habitContainer.innerHTML = '';
        habitContainer.appendChild(grid);
    };
    habitContainer.addEventListener('click', (e) => {
        const target = e.target;
        if (target.classList.contains('day-cell')) {
            const { habitIndex, date } = target.dataset;
            const habit = habits[habitIndex];
            const dateIndex = habit.dates.indexOf(date);
            if (dateIndex > -1) habit.dates.splice(dateIndex, 1);
            else habit.dates.push(date);
        } else if (target.classList.contains('delete-btn')) {
            habits.splice(target.dataset.habitIndex, 1);
        } else { return; }
        saveHabits(); renderHabitTracker();
    });
    addHabitBtn.addEventListener('click', () => {
        const name = habitInput.value.trim();
        if (name && !habits.find(h => h.name.toLowerCase() === name.toLowerCase())) {
            habits.push({ name, dates: [] });
            habitInput.value = '';
            saveHabits(); renderHabitTracker();
        }
    });

    // --- 8. Decision Spinner (No changes) ---
    // (minified for brevity as logic is unchanged)
    const canvas=document.getElementById("spinner-canvas"),ctx=canvas.getContext("2d"),spinBtn=document.getElementById("spin-btn"),optionInput=document.getElementById("spinner-option-input"),addOptionBtn=document.getElementById("add-spinner-option-btn"),optionsList=document.getElementById("spinner-options-list");let options=JSON.parse(localStorage.getItem("spinnerOptions"))||["Pizza","Tacos","Sushi","Pasta","Salad"];const colors=["#f82","#0bf","#fb0","#0fb","#b0f","#f0b","#bf0"];let startAngle=0,arc=0,spinTimeout=null,spinAngleStart=10,spinTime=0,spinTimeTotal=0;const saveSpinnerOptions=()=>localStorage.setItem("spinnerOptions",JSON.stringify(options));const renderOptionsList=()=>{optionsList.innerHTML="",options.forEach((o,i)=>{const l=document.createElement("li");l.innerHTML=`${o} <button class="delete-btn" data-index="${i}">&times;</button>`,optionsList.appendChild(l)})};optionsList.addEventListener("click",e=>{if(e.target.classList.contains("delete-btn")){options.splice(e.target.dataset.index,1);saveSpinnerOptions();drawSpinner();renderOptionsList()}});addOptionBtn.addEventListener("click",()=>{const o=optionInput.value.trim();o&&!options.includes(o)&&(options.push(o),optionInput.value="",saveSpinnerOptions(),drawSpinner(),renderOptionsList())});function drawSpinner(){const r=canvas.width/2.2,t=r*.75;arc=Math.PI/(options.length/2),ctx.clearRect(0,0,canvas.width,canvas.height),ctx.strokeStyle="var(--border-color)",ctx.lineWidth=2,ctx.font="14px "+getComputedStyle(document.documentElement).getPropertyValue("--font-family");for(let i=0;i<options.length;i++){let e=startAngle+i*arc;ctx.fillStyle=colors[i%colors.length],ctx.beginPath(),ctx.arc(canvas.width/2,canvas.height/2,r,e,e+arc,!1),ctx.arc(canvas.width/2,canvas.height/2,0,e+arc,e,!0),ctx.stroke(),ctx.fill(),ctx.save(),ctx.fillStyle="white",ctx.translate(canvas.width/2+Math.cos(e+arc/2)*t,canvas.height/2+Math.sin(e+arc/2)*t),ctx.rotate(e+arc/2+Math.PI/2);let n=options[i];ctx.fillText(n,-ctx.measureText(n).width/2,0),ctx.restore()}}
    function easeOut(t,b,c,d){let ts=(t/=d)*t;let tc=ts*t;return b+c*(tc+-3*ts+3*t)}function rotate(){spinTime+=30;if(spinTime>=spinTimeTotal){clearTimeout(spinTimeout);let d=startAngle*180/Math.PI+90,a=arc*180/Math.PI,i=Math.floor((360-d%360)/a);ctx.save(),ctx.font="bold 20px "+getComputedStyle(document.documentElement).getPropertyValue("--font-family");let t=options[i];ctx.fillText(t,canvas.width/2-ctx.measureText(t).width/2,canvas.height/2+10),ctx.restore(),spinBtn.disabled=!1;return}let s=spinAngleStart-easeOut(spinTime,0,spinAngleStart,spinTimeTotal);startAngle+=s*Math.PI/180,drawSpinner(),spinTimeout=setTimeout(rotate,30)}spinBtn.addEventListener("click",()=>{spinBtn.disabled=!0,spinAngleStart=10*Math.random()+10,spinTime=0,spinTimeTotal=3e3*Math.random()+4e3,rotate()});

    // --- DANGER ZONE: Reset Data (No changes) ---
    document.getElementById('reset-data-btn').addEventListener('click', () => {
        if (window.confirm('Are you sure you want to delete ALL your data? This action cannot be undone.')) {
            localStorage.clear();
            location.reload();
        }
    });

    // --- INITIALIZE ALL WIDGETS ---
    function initializeDashboard() {
        renderTodos();
        fetchQuote();
        showFlashcard();
        renderFlashcardList();
        renderHabitTracker();
        
        const spinnerSize = document.querySelector('.spinner-container').clientWidth;
        canvas.width = spinnerSize; canvas.height = spinnerSize;
        drawSpinner(); renderOptionsList();
    }
    initializeDashboard();
});
</script>

</body>
</html>