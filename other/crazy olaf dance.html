<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>New Olaf's Happy Dance</title>
    <style>
        body {
            font-family: sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #a0d8ef;
            margin: 0;
            overflow: hidden;
        }

        #olaf-v2 {
            width: 500px;
            max-width: 90vw;
        }

        /* Set a global transition for all elements that will move */
        #olaf-v2 g, #olaf-v2 path, #olaf-v2 circle, #olaf-v2 ellipse {
            transition: transform 0.25s ease-in-out;
        }
        
        /* THE ARM FIX: Define shoulder pivot points for natural rotation */
        #olaf-v2 #left-arm {
            transform-origin: 160px 425px;
        }
        #olaf-v2 #right-arm {
            transform-origin: 340px 425px;
        }
        
        /* --- DANCE STATE: LEFT --- */
        /* These transforms are extracted from your "dance-left.svg" */
        #olaf-v2.dance-left #olaf-character {
             transform: matrix(1.00713, 0, 0, 1.00713, -12.2818, -5.8335);
        }
        #olaf-v2.dance-left .background-shadow { /* Added a class for the shadow */
            transform: translate(23px, 20px);
        }
        #olaf-v2.dance-left #right-foot {
            transform: scale(1.21) translate(-61px, -102px); /* Simplified from matrix */
        }
        #olaf-v2.dance-left #lower-body {
            transform: matrix(0.994015, 0.109244, -0.109244, 0.994015, 65.7199, -23.6282);
        }
        #olaf-v2.dance-left #buttons circle:nth-child(2) { transform: translate(15px, 7px); }
        #olaf-v2.dance-left #buttons circle:nth-child(3) { transform: translate(-9px, 13px); }
        #olaf-v2.dance-left #mouth {
            transform: matrix(1.22445, 0.194701, -0.194701, 1.22445, 13.3443, -122.66);
        }
        #olaf-v2.dance-left #tooth {
             transform: matrix(1.09977, -0.0180427, 0.0180427, 1.09977, -29.1445, -21.2041);
        }
        #olaf-v2.dance-left #right-eye-pupil { transform: translate(3px, 11px); }
        #olaf-v2.dance-left #left-eye-pupil { transform: translate(-8px, 10px); }
        #olaf-v2.dance-left #carrot-nose {
             transform: matrix(-1.24271, 1.5102, -1.5102, -1.24271, 1021.26, 299.429);
        }
        /* Manual arm rotations for a clean swing */
        #olaf-v2.dance-left #left-arm {
            transform: rotate(-135deg) translate(-20px, 10px); /* Up and back */
        }
        #olaf-v2.dance-left #right-arm {
            transform: rotate(60deg) translateY(10px); /* Down and back */
        }
        
        /* --- DANCE STATE: RIGHT (Mirrored) --- */
        #olaf-v2.dance-right #olaf-character {
            transform: matrix(1.00713, 0, 0, 1.00713, 6.2818, -5.8335) scaleX(-1);
            /* A full mirror is easiest at the top level */
        }
        /* We need to re-mirror text if it exists, and sometimes re-apply transforms */
        #olaf-v2.dance-right g {
            transform-origin: 250px 400px; /* Set a central origin for the mirror */
        }
        
    </style>
</head>
<body>
    
    <!-- This is the BASE "Normal pose" SVG -->
    <svg id="olaf-v2" width="500" height="700" viewBox="0 0 500 700" xmlns="http://www.w3.org/2000/svg" aria-labelledby="olafTitleV3" role="img">
      <title id="olafTitle">A vector illustration of Olaf.</title>
      <defs>
        <style>
          .snowman-fill { fill: #F1F8FF; } .snowman-stroke { stroke: #DDE8F2; stroke-width: 4; }
          .twig-brown { fill: #8B4513; } .coal-black { fill: #2C2C2C; }
          .mouth-brown { fill: #8c3b32; } .carrot-orange { fill: #F39C12; }
          .carrot-stroke { stroke: #E67E22; stroke-width: 1.5; }
        </style>
      </defs>
      <ellipse class="background-shadow" cx="250" cy="650" rx="160" ry="20" fill="#E8F0F8"/>
      <g id="olaf-character" transform="matrix(1.00713 0 0 1.00713 -3.28179 15.1665)">
        <g id="feet">
            <path id="left-foot" class="snowman-fill snowman-stroke" d="M140,640 C 90,650 90,680 145,675 C 170,672 170,645 140,640 Z"/>
            <path id="right-foot" class="snowman-fill snowman-stroke" d="M360,640 C 410,650 410,680 355,675 C 330,672 330,645 360,640 Z"/>
        </g>
        <path id="lower-body" class="snowman-fill snowman-stroke" d="M100,640 C 40,560 100,460 250,460 C 400,460 460,560 400,640 C 350,690 150,690 100,640 Z"/>
        <path id="middle-body" class="snowman-fill snowman-stroke" d="M160,475 C 130,440 170,360 250,360 C 330,360 370,440 340,475 C 310,515 190,515 160,475 Z" transform="matrix(0.998424 -0.0561197 0.0561197 0.998424 -23.9072 21.6566)"/>
        <g id="buttons" class="coal-black">
          <circle cx="250" cy="425" r="14" transform="matrix(1 0 0 1 4 7)"/>
          <circle cx="250" cy="535" r="16"/>
          <circle cx="250" cy="585" r="16"/>
        </g>
        <g id="arms" stroke="#8B4513" stroke-width="10" stroke-linecap="round" stroke-linejoin="round">
          <path id="right-arm" d="M340,425 Q 400,390 440,360 M440,360 L 420,330 M440,360 L 460,340" fill="none" transform="matrix(0.872177 -0.48919 0.48919 0.872177 -168.331 236.002)"/>
          <path id="left-arm" d="M160,425 Q 100,390 60,360 M60,360 L 80,330 M60,360 L 40,340" fill="none" transform="matrix(0.899815 -0.436271 0.436271 0.899815 -155.722 112.115)"/>
        </g>
        <g id="head">
          <path id="head-shape" class="snowman-fill snowman-stroke" d="M175,370 C 150,280 180,150 250,150 C 320,150 350,280 325,370 C 300,420 200,420 175,370 Z" transform="matrix(1.09993 0 0 1.09993 -26.1033 -52.5652)"/>
          <g id="mouth-area">
            <path id="mouth" class="mouth-brown" d="M190,325 Q 250,345 310,325 Q 250,390 190,325 Z"/>
            <path id="tooth" d="M242,326 H 262 V 342 H 242 Z" fill="#FFFFFF" transform="matrix(1.09143 -0.136419 0.136419 1.09143 -68.474 11.2027)"/>
          </g>
          <g id="eyes">
            <circle id="right-eye-white" cx="280" cy="270" r="28" fill="#FFFFFF" stroke="#2C2C2C" stroke-width="3" transform="matrix(1 0 0 1 13 4)"/>
            <circle id="right-eye-pupil" class="coal-black" cx="280" cy="270" r="14"/>
            <circle id="left-eye-white" cx="220" cy="270" r="28" fill="#FFFFFF" stroke="#2C2C2C" stroke-width="3"/>
            <circle id="left-eye-pupil" class="coal-black" cx="220" cy="270" r="14" transform="matrix(1 0 0 1 -3 0)"/>
          </g>
          <g id="eyebrows" stroke="#65320d" stroke-width="8" stroke-linecap="round">
            <path id="right-eyebrow" d="M265,240 Q 285,230 310,245" fill="none" transform="matrix(0.830822 -0.556539 0.556539 0.830822 -90.8123 200.863)"/>
            <path id="left-eyebrow" d="M235,240 Q 215,230 190,245" fill="none" transform="matrix(1.08481 0 0 1.08481 -20.0437 -33.7883)"/>
          </g>
          <g id="nose-group" transform="rotate(12, 250, 295)">
            <path id="carrot-nose" class="carrot-orange carrot-stroke" d="M250,290 L 330,295 L 255,305 Z" transform="matrix(1.69426 0 0 1.69426 -168.633 -194.345)"/>
          </g>
          <g id="hair" stroke="#8B4513" stroke-width="8" stroke-linecap="round" transform="matrix(1.71017 -0.531905 0.531905 1.71017 -260.777 -5.12719)">
            <path id="hair-1" d="M250,155 L 250,125" transform="matrix(-0.973345 -0.241565 0.241565 -0.973345 461 333.771)"/>
            <path id="hair-2" d="M250,152 L 235,128" transform="matrix(1 0 0 1 0 7)"/>
            <path id="hair-3" d="M250,152 L 265,128" transform="matrix(1 0 0 1 0 9)"/>
          </g>
        </g>
      </g>
    </svg>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const olaf = document.getElementById('olaf-v2');
            
            // To create the mirrored 'dance-right' pose, we can just apply all the
            // 'dance-left' transforms and then flip the entire character horizontally.
            // This is simpler than calculating every single mirrored matrix.
            const rightDanceIsMirroredLeft = true;

            const danceSequence = ['dance-left', null, 'dance-right', null];
            let currentStep = 0;

            function doDanceStep() {
                const currentMove = danceSequence[currentStep];

                // Reset states
                olaf.classList.remove('dance-left', 'dance-right');
                olaf.querySelector('#olaf-character').style.transform = 'matrix(1.00713, 0, 0, 1.00713, -3.28179, 15.1665)';

                if (currentMove === 'dance-left') {
                    olaf.classList.add('dance-left');
                } else if (currentMove === 'dance-right') {
                    // Apply left-dance styles, then flip the whole thing
                    olaf.classList.add('dance-left'); // Get the pose
                    olaf.querySelector('#olaf-character').style.transform += ' scaleX(-1)'; // Add the mirror
                }
                
                currentStep = (currentStep + 1) % danceSequence.length;
            }

            setInterval(doDanceStep, 1000);
        });
    </script>
</body>
</html>